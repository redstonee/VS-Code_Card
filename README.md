# VS-Code Card
It's a boring PCB card with some leds and a button.
It's powered by a CR1220 battery and it's controlled by STM32G030C6T6.  
The PCB project is open-sourced at [OSHWHub](https://oshwhub.com/dc_redstone/vs-code).

## Software
### Prerequisites
The project is generated by STM32CubeMX and it's built with CMake.

* `ARM GNU Toolchain` - Used to compile the project
* `CMake` - Used to build the project
* `OpenOCD` or so - Used to flash the firmware
* `STM32CubeMX` - Optional, if you want to regenerate the project

### Build
You can build the project with the following steps:  

0. Install required tools mentioned above and clone the project:
```bash
git clone https://github.com/redstonee/VS-Code_Card
cd VS-Code_Card
```

1. Build the project:
```bash
mkdir build
cd build
cmake -G "Unix Makefiles" ..
cmake --build .
```
And you will find the binary file `VS_Code.elf` in the `build` directory if the build is successful.

2. Flash the project:  
The firmware can be flashed with ST-Link or any other SWD programmer.  
To flash with ST-Link, you can use the following command:
```bash
openocd -f interface/stlink.cfg -f target/stm32g0x.cfg -c "program VS_Code.elf verify reset exit"
```

To flash with CMSIS-DAP, you can use the following command:
```bash
openocd -f interface/cmsis-dap.cfg -f target/stm32g0x.cfg -c "program VS_Code.elf verify reset exit"
```

*Note: if the MCU falls asleep,
you need to press the button to wake it up when flashing,
or the programmer will not be able to connect to the MCU.*

## Usage
Just press the button and the leds will light up in a sequence, then turn off and enter low power mode.  
In low power mode, the power consumption is about 1uA in my test.